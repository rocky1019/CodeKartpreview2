<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - CodeKart</title>
  <link rel="icon" type="image/png" href="assets/images/Technological_Circuit_Logo_in_Orange-removebg-preview.png" />
  <style>
    :root {
      --primary:#FF6B6B; --secondary:#4ECDC4; --bg:#f4f4f4; --card:#fff; --text:#111;
    }
    *{ box-sizing:border-box; margin:0; padding:0; font-family:'Poppins',sans-serif; }
    body{ background:var(--bg); color:var(--text); }

    /* Navbar */
    header.navbar{ display:flex; justify-content:space-between; align-items:center; padding:1rem 2rem; background:var(--card); box-shadow:0 2px 5px rgba(0,0,0,.1); position:sticky; top:0; z-index:10; }
    #logo{ display:flex; align-items:center; gap:8px; font-size:1.5rem; font-weight:bold; color:var(--primary); }
    #logo img{ height:40px; width:auto; }
    nav ul{ display:flex; gap:2rem; list-style:none; }
    nav ul li a{ color:var(--text); text-decoration:none; transition:.3s; }
    nav ul li a:hover, nav ul li a.active{ color:var(--primary); }
    .hamburger{ display:none; font-size:2rem; cursor:pointer; }

    /* Auth */
    .auth-section{ display:flex; justify-content:center; align-items:center; min-height:80vh; padding:2rem; }
    .auth-card{ background:var(--card); padding:2rem; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,.08); width:100%; max-width:400px; text-align:center; }
    .auth-card h2{ color:var(--primary); margin-bottom:1rem; }
    .auth-card form{ display:flex; flex-direction:column; gap:1rem; }
    .auth-card input{ padding:.8rem; border:1px solid #ddd; border-radius:8px; outline:none; }
    .auth-card input:focus{ border-color:var(--primary); }
    .auth-card button{ padding:.8rem; border:none; border-radius:8px; background:var(--primary); color:#fff; font-weight:bold; cursor:pointer; transition:.2s; }
    .auth-card button:hover{ background:#e05555; }
    .auth-card p{ margin-top:1rem; font-size:.9rem; }
    .auth-card p a{ color:var(--secondary); }
    .row{ display:flex; justify-content:space-between; align-items:center; font-size:.9rem; }
    .error{ color:#d64545; min-height:1.2rem; font-size:.9rem; }
    .success{ color:#1b8a5a; min-height:1.2rem; font-size:.9rem; }

    /* Mobile nav */
    @media(max-width:768px){
      nav ul{ flex-direction:column; gap:1rem; display:none; }
      nav ul.active{ display:flex; }
      .hamburger{ display:block; }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div id="logo">
 <img src="assets/images/Technological_Circuit_Logo_in_Orange-removebg-preview.png" alt="CodeKart Logo">      <span>CodeKart</span>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="prouduct.html">Explore</a></li>
        <li><a href="sell.html">Sell</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
    <div class="hamburger">&#9776;</div>
  </header>

  <!-- Login -->
  <section class="auth-section">
    <div class="auth-card">
      <h2>Login</h2>
      <form id="login-form">
        <input id="email" type="email" placeholder="Email" required />
        <input id="password" type="password" placeholder="Password" required />
        <div class="row">
          <label><input id="remember" type="checkbox" /> Remember me</label>
          <a id="forgot" href="#" style="text-decoration:none;">Forgot password?</a>
        </div>
        <button type="submit" id="login-btn">Login</button>
        <div class="error" id="error"></div>
        <div class="success" id="success"></div>
      </form>
      <p>Don’t have an account? <a href="signup.html">Sign Up</a></p>
    </div>
  </section>

  <script>
    const hamburger = document.querySelector('.hamburger');
    const navLinks = document.querySelector('nav ul');
    hamburger.addEventListener('click', () => navLinks.classList.toggle('active'));
  </script>

  <!-- Firebase + Login logic -->
  <script type="module">
    // Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
    import { 
      getAuth, setPersistence, browserLocalPersistence, browserSessionPersistence,
      signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged 
    } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

    // Your Firebase config (same as signup)
    const firebaseConfig = {
      apiKey: "AIzaSyDIt727HxMoAk8jMwhLH2-zcLXGmBdj_Ys",
      authDomain: "codekart-5652e.firebaseapp.com",
      projectId: "codekart-5652e",
      storageBucket: "codekart-5652e.firebasestorage.app",
      messagingSenderId: "430655059434",
      appId: "1:430655059434:web:290df76af0c7bf8c882e93",
      measurementId: "G-WHPZ6BWZ4Q"
    };

    // Init
    const app = initializeApp(firebaseConfig);
    try { getAnalytics(app); } catch(e) {}
    const auth = getAuth(app);

    // Helpers
    const $ = (id) => document.getElementById(id);
    const form = $("login-form");
    const errBox = $("error");
    const okBox = $("success");
    const loginBtn = $("login-btn");

    function showError(msg){ errBox.textContent = msg; okBox.textContent = ""; }
    function showSuccess(msg){ okBox.textContent = msg; errBox.textContent = ""; }

    // Forgot password
    $("forgot").addEventListener("click", async (e) => {
      e.preventDefault();
      const email = $("email").value.trim();
      if (!email) return showError("Enter your email first to reset password.");
      try {
        await sendPasswordResetEmail(auth, email);
        showSuccess("Password reset email sent.");
      } catch (err) {
        let msg = "Couldn't send reset email.";
        if (err.code === "auth/user-not-found") msg = "No account with that email.";
        if (err.code === "auth/invalid-email") msg = "Invalid email.";
        showError(msg);
        console.error(err);
      }
    });

    // Login submit
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      showError(""); showSuccess("");
      const email = $("email").value.trim();
      const pass = $("password").value;
      const remember = $("remember").checked;

      loginBtn.disabled = true;

      try {
        await setPersistence(auth, remember ? browserLocalPersistence : browserSessionPersistence);
        const cred = await signInWithEmailAndPassword(auth, email, pass);
        showSuccess("Logged in! Redirecting…");

        // TODO: change destination if you have a dashboard
        setTimeout(() => { window.location.href = "index.html"; }, 800);
      } catch (err) {
        let msg = "Login failed. Check your details.";
        if (err.code === "auth/invalid-credential") msg = "Invalid email or password.";
        if (err.code === "auth/user-disabled") msg = "Account disabled.";
        if (err.code === "auth/too-many-requests") msg = "Too many attempts. Try later.";
        showError(msg);
        console.error(err);
      } finally {
        loginBtn.disabled = false;
      }
    });

    // Optional: if already logged in, send away from login page
    onAuthStateChanged(auth, (user) => {
      if (user) {
        // Already logged in — skip login page
        // setTimeout(() => { window.location.href = "index.html"; }, 300);
      }
    });
  </script>
</body>
</html>
